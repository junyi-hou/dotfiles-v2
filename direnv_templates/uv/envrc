set -euo pipefail

export UV_NO_MODIFY_PATH=1
export UV_INSTALL_DIR="$(pwd)/.tools/bin"
export UV_NO_PROGRESS=1

if [ ! -f .tools/bin/uv ]; then
    echo "uv not found locally, installing..."
    mkdir -p .tools
    curl -LsSf https://astral.sh/uv/install.sh | sh -s -- 
fi

# Ensure local uv is in PATH
export PATH="$(pwd)/.tools/bin:$PATH"

if [ ! -d .venv ]; then
    uv venv .venv --python "==3.12"
fi

# Activate the virtual environment
source .venv/bin/activate

uv sync --all-groups --no-install-project --frozen

# Local Variables:
# mode: bash-ts
# End:
